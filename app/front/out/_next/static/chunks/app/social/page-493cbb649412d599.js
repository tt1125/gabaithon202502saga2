(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[440],{1890:(e,t,r)=>{Promise.resolve().then(r.bind(r,3571))},3571:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(5155),n=r(2115),i=r(8562),o=r(8998),a=r(562),l=r(810);function c(e){let{postData:t}=e;return(0,s.jsx)(i.A,{elevation:1,sx:{mb:2,borderRadius:2,overflow:"hidden",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:3}},onClick:()=>{alert("コメントが押された")},children:(0,s.jsxs)(o.A,{sx:{display:"flex",p:2},children:[(0,s.jsx)(a.A,{src:t.img_url,sx:{width:56,height:56,bgcolor:"#9333EA",mr:2}}),(0,s.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,s.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[(0,s.jsx)(l.A,{variant:"subtitle1",sx:{fontWeight:"bold"},children:t.name}),(0,s.jsx)(l.A,{variant:"caption",sx:{color:"text.secondary"},children:t.created_at})]}),(0,s.jsx)(l.A,{variant:"subtitle2",sx:{fontWeight:"medium",color:"#4F46E5",mb:.5},children:t.title}),(0,s.jsx)(l.A,{variant:"body2",sx:{color:"text.secondary"},children:t.comment})]})]})})}var d=r(3376),x=r(6793),h=r(2560),u=r(1441),f=r(6854),p=r(4918),g=r(2983);let m=(0,g.A)((0,s.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),v=(0,g.A)((0,s.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout"),b=(0,g.A)((0,s.jsx)("path",{d:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2M9.8 8.9 7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6z"}),"DirectionsWalk");var j=r(415);function y(){var e,t;let{logout:r}=(0,d.Z)(),i=(0,n.useContext)(d.c),g=null===(e=i.user)||void 0===e?void 0:e.displayName,y=null===(t=i.user)||void 0===t?void 0:t.photoURL,[w,A]=(0,n.useState)([]),[C,I]=(0,n.useState)([]),[N,S]=(0,n.useState)(""),[k,_]=(0,n.useState)(0),[z,E]=(0,n.useState)(!1),[W,L]=(0,n.useState)(!0),[D,O]=(0,n.useState)(!1),P=(0,n.useRef)(null),M=async e=>{try{E(!0);let t=await fetch("".concat(j.h,"/get_recent_posts"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({offset:e})}),r=await t.json();Array.isArray(r.result)&&r.result.length>0?A(e=>[...e,...r.result]):L(!1)}catch(e){console.error("最新投稿の取得に失敗しました:",e)}finally{E(!1)}},T=async e=>{O(!0);try{let t=await fetch("".concat(j.h,"/api/search"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}),r=await t.json();I(r)}catch(e){console.error("検索に失敗しました:",e)}finally{O(!1)}};(0,n.useEffect)(()=>{M(0)},[]),(0,n.useEffect)(()=>{""===N.trim()&&W&&0!==k&&M(k)},[k,N,W]),(0,n.useEffect)(()=>{let e=new IntersectionObserver(e=>{e[0].isIntersecting&&!z&&W&&!D&&""===N.trim()&&_(e=>e+8)},{root:null,rootMargin:"0px",threshold:1});return P.current&&e.observe(P.current),()=>{P.current&&e.unobserve(P.current)}},[z,W,D,N]),(0,n.useEffect)(()=>{""===N.trim()?I([]):T(N.trim())},[N]);let B=N.trim()?C:w;return(0,s.jsx)("main",{style:{zIndex:5},className:"h-screen bg-gradient-to-r from-purple-500 to-indigo-600",children:(0,s.jsxs)(o.A,{sx:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",backgroundColor:"white"},children:[(0,s.jsxs)(o.A,{sx:{height:"128px",background:"linear-gradient(to right, #9333ea, #4f46e5)",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",position:"fixed",width:"100%",top:0,zIndex:1e3},children:[(0,s.jsxs)(o.A,{sx:{position:"absolute",inset:0,opacity:.2},children:[(0,s.jsx)(b,{sx:{position:"absolute",top:"16px",left:"16px",width:"32px",height:"32px",color:"white"}}),(0,s.jsx)(b,{sx:{position:"absolute",bottom:"16px",right:"16px",width:"32px",height:"32px",color:"white"}})]}),(0,s.jsx)(l.A,{variant:"h4",sx:{fontWeight:"bold",color:"white",zIndex:10},children:"WalkBuddy"})]}),(0,s.jsxs)(o.A,{sx:{px:4,py:2,display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1,marginTop:"160px"},children:[(0,s.jsxs)(o.A,{sx:{maxWidth:"600px",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[(0,s.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(a.A,{sx:{bgcolor:"#9e9e9e",mr:1},src:null!=y?y:""}),(0,s.jsx)(l.A,{variant:"subtitle1",children:g})]}),(0,s.jsx)(x.A,{variant:"contained",color:"secondary",size:"small",onClick:r,startIcon:(0,s.jsx)(v,{}),sx:{background:"linear-gradient(to right, #9333ea, #4f46e5)",color:"white","&:hover":{background:"linear-gradient(to right, #7e22ce, #4338ca)"}},children:"ログアウト"})]}),(0,s.jsx)(o.A,{sx:{width:"100%",maxWidth:"800px",mb:4},children:(0,s.jsx)(h.A,{value:N,onChange:e=>S(e.target.value),variant:"outlined",placeholder:"検索",fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:"9999px","&:hover fieldset":{borderColor:"#9333ea"},"&.Mui-focused fieldset":{borderColor:"#4f46e5"}}},InputProps:{startAdornment:(0,s.jsx)(u.A,{position:"start",children:(0,s.jsx)(m,{sx:{color:"gray",mr:1}})})}})}),D&&(0,s.jsxs)(o.A,{sx:{mb:2,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,s.jsx)(f.A,{color:"secondary"}),(0,s.jsx)(l.A,{variant:"body2",sx:{mt:3},children:"検索中"})]}),(0,s.jsx)(p.A,{sx:{width:"100%",maxWidth:"90%",mx:"auto",mb:4},children:B.map((e,t)=>(0,s.jsx)(c,{postData:e},t))}),(0,s.jsx)(o.A,{ref:P,sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50px"},children:z&&!D&&(0,s.jsx)(f.A,{color:"secondary"})})]}),(0,s.jsx)(o.A,{sx:{p:2,textAlign:"center"},children:(0,s.jsx)(l.A,{variant:"caption",sx:{color:"text.secondary"},children:"毎日の一歩が、健康な未来への一歩"})})]})})}},3312:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var s=r(5155),n=r(2115),i=r(1290),o=r(1027),a=r(1567);let l=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:r,variant:n,size:o,asChild:c=!1,...d}=e,x=c?i.DX:"button";return(0,s.jsx)(x,{className:(0,a.cn)(l({variant:n,size:o,className:r})),ref:t,...d})});c.displayName="Button"},415:(e,t,r)=>{"use strict";r.d(t,{h:()=>s});let s="dev"==r(2818).env.NEXT_PUBLIC_ENV?"http://localhost:5000":""},3376:(e,t,r)=>{"use strict";r.d(t,{c:()=>x,AuthProvider:()=>u,Z:()=>h});var s=r(5155),n=r(9904),i=r(2115),o=r(4565),a=r(9506),l=r(3312),c=r(2734);function d(){let{login:e}=h();return(0,s.jsx)("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-purple-900 via-purple-700 to-indigo-800",children:(0,s.jsx)("div",{className:"w-full max-w-md px-4",children:(0,s.jsxs)("div",{className:"w-full rounded-xl overflow-hidden shadow-2xl",children:[(0,s.jsx)("div",{className:"text-white h-16 bg-gradient-to-r from-purple-500 to-indigo-600 flex items-center justify-center",children:(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"WALK"})}),(0,s.jsxs)("div",{className:"bg-white p-6 space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-purple-600 to-indigo-700 flex items-center justify-center",children:(0,s.jsx)(c.sqp,{className:"text-white h-10 w-10"})})}),(0,s.jsxs)(l.$,{onClick:e,variant:"outline",className:"w-full h-12 flex items-center justify-center gap-2 border-2 hover:bg-purple-50 transition-colors",children:[(0,s.jsx)(a.F4b,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Googleでログイン"})]})]})]})})})}let x=(0,i.createContext)({user:null,login:()=>{},logout:()=>{}});function h(){return(0,i.useContext)(x)}function u(e){let{children:t}=e,[r,a]=(0,i.useState)(void 0),l=(0,n.Wp)({apiKey:"AIzaSyBN-sIZx-rSCZ2nrjZFZhS4qIo1K1r2tLs",authDomain:"gabaithon202502saga2.firebaseapp.com",projectId:"gabaithon202502saga2",storageBucket:"gabaithon202502saga2.firebasestorage.app",messagingSenderId:"328048708813",appId:"1:328048708813:web:e4e38562abb11647c86d84",measurementId:"G-26GBYYVT0S"}),c=(0,o.xI)(l),h=new o.HF,u=async()=>{a((await (0,o.df)(c,h)).user)},f=async()=>{await (0,o.CI)(c),a(null)};return(0,i.useEffect)(()=>{c.onAuthStateChanged(e=>a(e))},[]),(0,s.jsx)(x.Provider,{value:{user:r,login:u,logout:f},children:r?t:null===r?(0,s.jsx)(d,{}):(0,s.jsx)("div",{children:"loading..."})})}},1567:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var s=r(3463),n=r(9795);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[87,753,895,375,535,441,517,358],()=>t(1890)),_N_E=e.O()}]);