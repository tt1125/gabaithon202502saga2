"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[564],{757:(e,t,r)=>{r.d(t,{A:()=>l});var o=r(5155),n=r(3478),a=r(5355);function l(e){let{message:t="読み込み中..."}=e;return(0,o.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-purple-900 via-purple-700 to-indigo-800 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center space-y-6",children:[(0,o.jsxs)("div",{className:"relative w-32 h-32 mx-auto",children:[[void 0,void 0,void 0].map((e,t)=>(0,o.jsx)(n.P.div,{className:"absolute inset-0",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2*t},children:(0,o.jsx)(n.P.div,{animate:{rotate:360},transition:{duration:2-.5*t,repeat:Number.POSITIVE_INFINITY,ease:"linear"},className:"w-full h-full rounded-full border-4 border-transparent\n                ".concat(0===t?"border-t-purple-500":1===t?"border-r-pink-500":"border-b-indigo-500"),style:{borderWidth:"".concat(4-t,"px")}})},t)),(0,o.jsx)(n.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"absolute inset-0 m-auto w-24 h-24 rounded-full bg-gradient-to-br from-purple-400 to-indigo-500 flex items-center justify-center",children:(0,o.jsx)(a.A,{className:"h-12 w-12 text-white"})})]}),(0,o.jsx)("div",{className:"flex justify-center space-x-2",children:[0,1,2].map(e=>(0,o.jsx)(n.P.div,{initial:{scale:0},animate:{scale:[0,1,0]},transition:{duration:1,repeat:Number.POSITIVE_INFINITY,delay:.2*e,ease:"easeInOut"},className:"w-3 h-3 bg-white rounded-full"},e))}),(0,o.jsx)(n.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-white text-lg font-medium",children:t})]})})}},3312:(e,t,r)=>{r.d(t,{$:()=>c});var o=r(5155),n=r(2115),a=r(1290),l=r(1027),i=r(1567);let s=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:r,variant:n,size:l,asChild:c=!1,...u}=e,g=c?a.DX:"button";return(0,o.jsx)(g,{className:(0,i.cn)(s({variant:n,size:l,className:r})),ref:t,...u})});c.displayName="Button"},3376:(e,t,r)=>{r.d(t,{c:()=>d,AuthProvider:()=>m,Z:()=>p});var o=r(5155),n=r(9904),a=r(2115),l=r(4565),i=r(9506),s=r(3312),c=r(2734);function u(){let{login:e}=p();return(0,o.jsx)("div",{className:"min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-purple-900 via-purple-700 to-indigo-800",children:(0,o.jsx)("div",{className:"w-full max-w-md px-4",children:(0,o.jsxs)("div",{className:"w-full rounded-xl overflow-hidden shadow-2xl",children:[(0,o.jsx)("div",{className:"text-white h-16 bg-gradient-to-r from-purple-500 to-indigo-600 flex items-center justify-center",children:(0,o.jsx)("h1",{className:"text-2xl font-bold",children:" WalkBuddy"})}),(0,o.jsxs)("div",{className:"bg-white p-6 space-y-6",children:[(0,o.jsx)("div",{className:"flex justify-center",children:(0,o.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-purple-600 to-indigo-700 flex items-center justify-center",children:(0,o.jsx)(c.sqp,{className:"text-white h-10 w-10"})})}),(0,o.jsxs)(s.$,{onClick:e,variant:"outline",className:"w-full h-12 flex items-center justify-center gap-2 border-2 hover:bg-purple-50 transition-colors",children:[(0,o.jsx)(i.F4b,{className:"h-5 w-5"}),(0,o.jsx)("span",{children:"Googleでログイン"})]})]})]})})})}var g=r(757);let d=(0,a.createContext)({user:null,login:()=>{},logout:()=>{}});function p(){return(0,a.useContext)(d)}function m(e){let{children:t}=e,[r,i]=(0,a.useState)(void 0),s=(0,n.Wp)({apiKey:"AIzaSyBN-sIZx-rSCZ2nrjZFZhS4qIo1K1r2tLs",authDomain:"gabaithon202502saga2.firebaseapp.com",projectId:"gabaithon202502saga2",storageBucket:"gabaithon202502saga2.firebasestorage.app",messagingSenderId:"328048708813",appId:"1:328048708813:web:e4e38562abb11647c86d84",measurementId:"G-26GBYYVT0S"}),c=(0,l.xI)(s),p=new l.HF,m=async()=>{i((await (0,l.df)(c,p)).user)},h=async()=>{await (0,l.CI)(c),i(null)};return(0,a.useEffect)(()=>{c.onAuthStateChanged(e=>i(e))},[]),(0,o.jsx)(d.Provider,{value:{user:r,login:m,logout:h},children:r?t:null===r?(0,o.jsx)(u,{}):(0,o.jsx)(g.A,{message:"認証中"})})}},7439:(e,t,r)=>{r.d(t,{GoogleMapProvider:()=>f,a:()=>m});var o=r(5155),n=r(2115),a=r(9047),l=r(5683),i=r(3478),s=r(7650),c=r(6039),u=r(3713),g=r(4333);function d(e){let{name:t,onComplete:r}=e,[a,d]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{d(!0);let e=setTimeout(()=>{null==r||r()},4e3);return()=>clearTimeout(e)},[r]),a)?(0,s.createPortal)((0,o.jsx)(l.N,{children:(0,o.jsxs)("div",{className:"fixed inset-0 pointer-events-none z-50 flex items-center justify-center",children:[(0,o.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),(0,o.jsxs)("div",{className:"relative",children:[[...Array(20)].map((e,t)=>(0,o.jsx)(i.P.div,{className:"absolute",initial:{opacity:0,scale:0,x:0,y:0},animate:{opacity:[0,1,0],scale:[.5,1.5,0],x:[0,(Math.random()-.5)*400],y:[0,(Math.random()-.5)*400]},transition:{duration:2,delay:.1*t,ease:"easeOut"},children:(0,o.jsx)(c.A,{className:"w-4 h-4 text-yellow-300",fill:"currentColor"})},t)),(0,o.jsx)(i.P.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",duration:.7,bounce:.5},className:"absolute -top-20  -translate-x-1/2",style:{left:"calc(50% - 20px)"},children:(0,o.jsx)(u.A,{className:"w-16 h-16 text-yellow-400",fill:"currentColor"})}),(0,o.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl p-6 shadow-xl flex flex-col items-center gap-4 relative",children:[(0,o.jsxs)(i.P.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},className:"text-3xl font-bold text-purple-600 flex items-center gap-2",children:[(0,o.jsx)(g.A,{className:"w-8 h-8"}),(0,o.jsx)("span",{children:"到着!!"})]}),(0,o.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-xl text-gray-700 font-medium text-center",children:t}),(0,o.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"text-sm text-gray-500",children:"おめでとうございます！"})]}),[...Array(30)].map((e,t)=>(0,o.jsx)(i.P.div,{className:"absolute left-1/2 -translate-x-1/2",initial:{opacity:0,scale:0,x:0,y:0},animate:{opacity:[0,1,1,0],scale:[0,1,1,0],x:[0,(Math.random()-.5)*400],y:[0,-400*Math.random()],rotate:[0,360*Math.random()]},transition:{duration:2,delay:.05*t,ease:"easeOut"},children:(0,o.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:["#7C3AED","#C026D3","#818CF8","#34D399"][Math.floor(4*Math.random())]}})},"confetti-".concat(t)))]})]})}),document.body):null}let p=(0,n.createContext)({active:!1,setActive:()=>{},isLoaded:!1,currentLat:0,currentLng:0});function m(){return(0,n.useContext)(p)}let h={width:"100%",height:"100%"};function f(e){var t,r;let{children:l}=e,[i,s]=(0,n.useState)(null),[c,u]=(0,n.useState)(!1),g=JSON.parse(localStorage.getItem("selectedRoute")||"[]"),m=g.point1,f=g.point2,v=g.point3,{isLoaded:x}=(0,a.KD)({googleMapsApiKey:"AIzaSyCsWEFEzwVzLk6PTAWxhc-6WZzMzFKmamI",language:"ja"});(0,n.useEffect)(()=>{g=JSON.parse(localStorage.getItem("selectedRoute")||"[]")},[c]);let y=(0,n.useRef)(null),b=(0,n.useRef)(null),w=(0,n.useRef)(null),I=(0,n.useRef)(null),N=(0,n.useRef)(null),j=(0,n.useRef)(null),M=(0,n.useRef)(null),S=(0,n.useRef)(null);function C(e){w.current&&I.current&&new google.maps.DirectionsService().route({origin:e,destination:{lat:m.lat,lng:m.lng},travelMode:google.maps.TravelMode.WALKING},(t,r)=>{if("OK"===r){var o,n;if(null===(o=I.current)||void 0===o||o.setDirections(t),50>google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(e.lat,e.lng),new google.maps.LatLng(m.lat,m.lng))){if(null===(n=I.current)||void 0===n||n.setMap(null),"1"==localStorage.getItem("progress")){let e=JSON.parse(localStorage.getItem("selectedRoute")||"{}").point1.name;K("「".concat(e,"」に到達しました!!")),P()}localStorage.setItem("progress","2")}else N.current&&N.current.setMap(w.current)}})}function L(e){w.current&&N.current&&new google.maps.DirectionsService().route({origin:e,destination:f,travelMode:google.maps.TravelMode.WALKING},(t,r)=>{if("OK"===r){var o,n;if(null===(o=N.current)||void 0===o||o.setDirections(t),50>google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(e.lat,e.lng),new google.maps.LatLng(f.lat,f.lng))){if(null===(n=N.current)||void 0===n||n.setMap(null),"2"==localStorage.getItem("progress")){let e=JSON.parse(localStorage.getItem("selectedRoute")||"{}").point2.name;K("「".concat(e,"」に到達しました!!")),P()}localStorage.setItem("progress","3")}else j.current&&j.current.setMap(w.current)}})}function k(e){w.current&&j.current&&new google.maps.DirectionsService().route({origin:e,destination:v,travelMode:google.maps.TravelMode.WALKING},(t,r)=>{if("OK"===r){var o,n;if(null===(o=j.current)||void 0===o||o.setDirections(t),50>google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(e.lat,e.lng),new google.maps.LatLng(v.lat,v.lng))){if(null===(n=j.current)||void 0===n||n.setMap(null),"3"==localStorage.getItem("progress")){localStorage.setItem("progress","4");let e=JSON.parse(localStorage.getItem("selectedRoute")||"{}").point3.name;K("「".concat(e,"」に到達しました!!")),P()}localStorage.setItem("progress","4")}else M.current&&M.current.setMap(w.current)}})}function D(e){w.current&&M.current&&b.current&&new google.maps.DirectionsService().route({origin:e,destination:b.current,travelMode:google.maps.TravelMode.WALKING},(t,r)=>{if("OK"===r&&b.current){var o,n;null===(o=M.current)||void 0===o||o.setDirections(t),50>google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(e.lat,e.lng),new google.maps.LatLng(b.current.lat,b.current.lng))&&(null===(n=M.current)||void 0===n||n.setMap(null),K("【目標達成】開始地点に到達しました!!"),P(),u(!1),localStorage.setItem("progress","5"))}})}(0,n.useEffect)(()=>{if(!navigator.geolocation){console.error("Geolocation not supported");return}let e=navigator.geolocation.watchPosition(e=>{let t={lat:e.coords.latitude,lng:e.coords.longitude};y.current=t,b.current||(b.current=t),s(t);let r=parseInt(localStorage.getItem("progress")||"1");r||(r=1),1==r?C(t):2==r?L(y.current):3==r?k(y.current):4==r&&D(y.current),S.current?S.current.setPosition(t):w.current&&c&&(S.current=new google.maps.Marker({position:t,map:w.current,icon:"http://maps.google.com/mapfiles/ms/icons/blue-dot.png"})),M.current&&b.current&&new google.maps.DirectionsService().route({origin:v,destination:b.current,travelMode:google.maps.TravelMode.WALKING},(e,t)=>{if("OK"===t){var r;null===(r=M.current)||void 0===r||r.setDirections(e)}})},e=>{console.error("Geolocation watchPosition error:",e)},{enableHighAccuracy:!0,maximumAge:2e3,timeout:5e3});return()=>{navigator.geolocation.clearWatch(e)}},[]),(0,n.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("progress")||"0");e>=1&&e<=4?u(!0):u(!1),navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{s({lat:e.coords.latitude,lng:e.coords.longitude})},e=>{console.error("Geolocation getCurrentPosition error:",e)},{enableHighAccuracy:!0}):console.error("Geolocation not supported")},[]);let{isPlaying:A,play:P,handleComplete:O}=function(){let[e,t]=(0,n.useState)(!1);return{isPlaying:e,play:(0,n.useCallback)(()=>{t(!0)},[]),handleComplete:(0,n.useCallback)(()=>{t(!1)},[])}}(),[W,K]=(0,n.useState)("");return(0,o.jsxs)(p.Provider,{value:{active:c,setActive:u,isLoaded:x,currentLat:(null===(t=y.current)||void 0===t?void 0:t.lat)||0,currentLng:(null===(r=y.current)||void 0===r?void 0:r.lng)||0},children:[A&&(0,o.jsx)(d,{name:W,onComplete:O}),x&&i&&c&&(0,o.jsx)("div",{style:{width:"100%",height:"100vh",position:"absolute",zIndex:-1},children:(0,o.jsx)(a.u6,{onLoad:function(e){w.current=e,!b.current&&y.current&&(b.current=y.current),y.current&&C(y.current),new google.maps.Marker({position:m,map:e,label:{text:"A",color:"white",fontWeight:"bold"},icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#4285F4",fillOpacity:1,strokeWeight:0,scale:15}}),new google.maps.Marker({position:f,map:e,label:{text:"B",color:"white",fontWeight:"bold"},icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#34A853",fillOpacity:1,strokeWeight:0,scale:15}}),new google.maps.Marker({position:v,map:e,label:{text:"C",color:"white",fontWeight:"bold"},icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#FBBC05",fillOpacity:1,strokeWeight:0,scale:15}}),b.current&&new google.maps.Marker({position:b.current,map:e,label:{text:"D",color:"white",fontWeight:"bold"},icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#DB4437",fillOpacity:1,strokeWeight:0,scale:15}}),e.addListener("click",e=>{if(e.latLng){let t={lat:e.latLng.lat(),lng:e.latLng.lng()};y.current=t,s(t);let r=parseInt(localStorage.getItem("progress")||"1");r||(r=1),1==r?C(t):2==r?(L(y.current),I.current&&I.current.setMap(null)):3==r?(k(y.current),I.current&&I.current.setMap(null),N.current&&N.current.setMap(null)):4==r&&(D(y.current),I.current&&I.current.setMap(null),N.current&&N.current.setMap(null),j.current&&j.current.setMap(null)),S.current?S.current.setPosition(t):w.current&&(S.current=new google.maps.Marker({position:t,map:w.current,icon:"http://maps.google.com/mapfiles/ms/icons/blue-dot.png"})),M.current&&b.current&&new google.maps.DirectionsService().route({origin:v,destination:b.current,travelMode:google.maps.TravelMode.WALKING},(e,t)=>{if("OK"===t){var r;null===(r=M.current)||void 0===r||r.setDirections(e)}})}}),5>parseInt(localStorage.getItem("progress")||"1")&&(M.current=new google.maps.DirectionsRenderer({polylineOptions:{strokeColor:"#DB4437",zIndex:1,strokeWeight:5},suppressMarkers:!0,preserveViewport:!0}),M.current.setMap(e)),4>parseInt(localStorage.getItem("progress")||"1")&&(j.current=new google.maps.DirectionsRenderer({polylineOptions:{strokeColor:"#FBBC05",zIndex:2,strokeWeight:5},suppressMarkers:!0,preserveViewport:!0}),j.current.setMap(e)),3>parseInt(localStorage.getItem("progress")||"1")&&(N.current=new google.maps.DirectionsRenderer({polylineOptions:{strokeColor:"#34A853",zIndex:3,strokeWeight:5},suppressMarkers:!0,preserveViewport:!0}),N.current.setMap(e)),2>parseInt(localStorage.getItem("progress")||"1")&&(I.current=new google.maps.DirectionsRenderer({polylineOptions:{strokeColor:"#4285F4",zIndex:4,strokeWeight:5},suppressMarkers:!0,preserveViewport:!0}),I.current.setMap(e)),function(){if(!w.current)return;let e=new google.maps.DirectionsService;y.current&&e.route({origin:v,destination:y.current,travelMode:google.maps.TravelMode.WALKING},(e,t)=>{"OK"===t&&M.current&&M.current.setDirections(e)}),e.route({origin:f,destination:v,travelMode:google.maps.TravelMode.WALKING},(e,t)=>{"OK"===t&&j.current&&j.current.setDirections(e)}),e.route({origin:m,destination:f,travelMode:google.maps.TravelMode.WALKING},(e,t)=>{"OK"===t&&N.current&&N.current.setDirections(e)})}()},mapContainerStyle:h,center:i,zoom:18,options:{mapTypeControl:!1,zoomControl:!0,streetViewControl:!1,fullscreenControl:!1}})}),l]})}},1567:(e,t,r)=>{r.d(t,{cn:()=>a});var o=r(3463),n=r(9795);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,o.$)(t))}}}]);